{"version":3,"file":"2.js","sources":["webpack:///./api/articles.js","webpack:///./pages/home/index.vue?1d71","webpack:///./api/tag.js","webpack:///./pages/home/index.vue","webpack:///./pages/home/index.vue?9d2f","webpack:///./pages/home/index.vue?eac9"],"sourcesContent":["import { request } from \"../plugins/request\"\r\n//user\r\nexport const getArticles = params => {\r\n    return request({\r\n        method: \"GET\",\r\n        url: \"/api/articles\",\r\n        params\r\n    })\r\n}\r\n\r\nexport const getFeedArticles = params => {\r\n    return request({\r\n        method: \"GET\",\r\n        url: \"/api/articles/feed\",\r\n        params,\r\n        // headers: {\r\n        //     Authorization: `Token eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6MTMwMzUzLCJ1c2VybmFtZSI6ImhhbmRzb21lMTIyIiwiZXhwIjoxNjEzODg2NTgwfQ.W9OY4mN9cUqTQ4chuKj8oT6mXQFqcmI3euEhh7Q-WBg`\r\n        // }\r\n    })\r\n}\r\n\r\nexport const addFavorite = (slug) => {\r\n    return request({\r\n        method: \"POST\",\r\n        url: `/api/articles/${slug}/favorite`,\r\n    })\r\n}\r\n\r\nexport const delFavorite = (slug) => {\r\n    return request({\r\n        method: \"DELETE\",\r\n        url: `/api/articles/${slug}/favorite`,\r\n    })\r\n}\r\n\r\nexport const getArticle = (slug) => {\r\n    return request({\r\n        method: \"GET\",\r\n        url: `/api/articles/${slug}`,\r\n    })\r\n}\r\n\r\nexport const getComments = (slug) => {\r\n    return request({\r\n        method: \"GET\",\r\n        url: `/api/articles/${slug}/comments`,\r\n    })\r\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"home-page\"},[_vm._ssrNode(\"<div class=\\\"banner\\\" data-v-d554f9d0><div class=\\\"container\\\" data-v-d554f9d0><h1 class=\\\"logo-font\\\" data-v-d554f9d0>conduit</h1> <p data-v-d554f9d0>A place to share your knowledge.</p></div></div> \"),_vm._ssrNode(\"<div class=\\\"container page\\\" data-v-d554f9d0>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"row\\\" data-v-d554f9d0>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"col-md-9\\\" data-v-d554f9d0>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"feed-toggle\\\" data-v-d554f9d0>\",\"</div>\",[_vm._ssrNode(\"<ul class=\\\"nav nav-pills outline-active\\\" data-v-d554f9d0>\",\"</ul>\",[(_vm.user)?_vm._ssrNode(\"<li class=\\\"nav-item\\\" data-v-d554f9d0>\",\"</li>\",[_c('nuxt-link',{staticClass:\"nav-link\",class:{\n                  active: _vm.tab === 'your_feed',\n                },attrs:{\"exact\":\"\",\"to\":{\n                  name: 'home',\n                  query: {\n                    tab: 'your_feed',\n                  },\n                }}},[_vm._v(\"Your Feed\")])],1):_vm._e(),_vm._ssrNode(\" \"),_vm._ssrNode(\"<li class=\\\"nav-item\\\" data-v-d554f9d0>\",\"</li>\",[_c('nuxt-link',{staticClass:\"nav-link\",class:{\n                  active: _vm.tab === 'global_feed',\n                },attrs:{\"exact\":\"\",\"to\":{\n                  name: 'home',\n                }}},[_vm._v(\"Global Feed\")])],1),_vm._ssrNode(\" \"),(_vm.tag)?_vm._ssrNode(\"<li class=\\\"nav-item\\\" data-v-d554f9d0>\",\"</li>\",[_c('nuxt-link',{staticClass:\"nav-link\",class:{\n                  active: _vm.tab === 'tag',\n                },attrs:{\"exact\":\"\",\"to\":{\n                  name: 'home',\n                  tag: _vm.tag,\n                }}},[_vm._v(\"#\"+_vm._s(_vm.tag))])],1):_vm._e()],2)]),_vm._ssrNode(\" \"),_vm._l((_vm.articles),function(article,index){return _vm._ssrNode(\"<div class=\\\"article-preview\\\" data-v-d554f9d0>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"article-meta\\\" data-v-d554f9d0>\",\"</div>\",[_c('nuxt-link',{attrs:{\"to\":{\n                name: 'profile',\n                params: {\n                  username: article.author.username,\n                },\n              }}},[_c('img',{attrs:{\"src\":article.author.image}})]),_vm._ssrNode(\" \"),_vm._ssrNode(\"<div class=\\\"info\\\" data-v-d554f9d0>\",\"</div>\",[_c('nuxt-link',{staticClass:\"author\",attrs:{\"to\":{\n                  name: 'profile',\n                  params: {\n                    username: article.author.username,\n                  },\n                }}},[_vm._v(_vm._s(article.author.username))]),_vm._ssrNode(\" <span class=\\\"date\\\" data-v-d554f9d0>\"+_vm._ssrEscape(_vm._s(_vm._f(\"date\")(article.createdAt)))+\"</span>\")],2),_vm._ssrNode(\" <button\"+(_vm._ssrAttr(\"disabled\",article.favoriteDisable))+(_vm._ssrClass(\"btn btn-outline-primary btn-sm pull-xs-right\",{\n                active: article.favorited,\n              }))+\" data-v-d554f9d0><i class=\\\"ion-heart\\\" data-v-d554f9d0></i>\"+_vm._ssrEscape(\" \"+_vm._s(article.favoritesCount)+\"\\n            \")+\"</button>\")],2),_vm._ssrNode(\" \"),_c('nuxt-link',{staticClass:\"preview-link\",attrs:{\"href\":\"\",\"to\":{\n              name: 'article',\n              params: {\n                slug: article.slug,\n              },\n            }}},[_c('h1',[_vm._v(_vm._s(article.title))]),_vm._v(\" \"),_c('p',[_vm._v(_vm._s(article.description))]),_vm._v(\" \"),_c('span',[_vm._v(\"Read more...\")])])],2)}),_vm._ssrNode(\" \"),_vm._ssrNode(\"<nav data-v-d554f9d0>\",\"</nav>\",[_vm._ssrNode(\"<ul class=\\\"pagination\\\" data-v-d554f9d0>\",\"</ul>\",_vm._l((_vm.totalPage),function(item){return _vm._ssrNode(\"<li\"+(_vm._ssrClass(\"page-item\",{\n                active: item === _vm.page,\n              }))+\" data-v-d554f9d0>\",\"</li>\",[_c('nuxt-link',{staticClass:\"page-link\",attrs:{\"to\":{\n                  name: 'home',\n                  query: {\n                    page: item,\n                    tag: _vm.$route.query.tag,\n                    tab: _vm.tab,\n                  },\n                }}},[_vm._v(_vm._s(item))])],1)}),0)])],2),_vm._ssrNode(\" <div class=\\\"col-md-3\\\" data-v-d554f9d0><div class=\\\"sidebar\\\" data-v-d554f9d0><p data-v-d554f9d0>Popular Tags</p> <div class=\\\"tag-list\\\" data-v-d554f9d0><a href class=\\\"tag-pill tag-default\\\" data-v-d554f9d0>programming</a> <a href class=\\\"tag-pill tag-default\\\" data-v-d554f9d0>javascript</a> <a href class=\\\"tag-pill tag-default\\\" data-v-d554f9d0>emberjs</a> <a href class=\\\"tag-pill tag-default\\\" data-v-d554f9d0>angularjs</a> <a href class=\\\"tag-pill tag-default\\\" data-v-d554f9d0>react</a> <a href class=\\\"tag-pill tag-default\\\" data-v-d554f9d0>mean</a> <a href class=\\\"tag-pill tag-default\\\" data-v-d554f9d0>node</a> <a href class=\\\"tag-pill tag-default\\\" data-v-d554f9d0>rails</a></div></div></div> \"),_vm._ssrNode(\"<div class=\\\"col-md-9\\\" data-v-d554f9d0>\",\"</div>\",[_vm._ssrNode(\"<div class=\\\"sidebar\\\" data-v-d554f9d0>\",\"</div>\",[_vm._ssrNode(\"<p data-v-d554f9d0>Popular Tags</p> \"),_vm._ssrNode(\"<div class=\\\"tag-list\\\" data-v-d554f9d0>\",\"</div>\",_vm._l((_vm.tagResult),function(item,index){return _c('nuxt-link',{key:index,staticClass:\"tag-pill tag-default\",attrs:{\"to\":{\n                name: 'home',\n                query: {\n                  tab: 'tag',\n                  tag: item,\n                },\n              }}},[_vm._v(_vm._s(item))])}),1)],2)])],2)])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//获取文章标签列表\r\nimport { request } from \"../plugins/request\"\r\nexport const getTags = () => {\r\n    return request({\r\n        method: \"GET\",\r\n        url: \"/api/tags\",\r\n\r\n    })\r\n}","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {\n  getArticles,\n  getFeedArticles,\n  addFavorite,\n  delFavorite,\n} from \"../../api/articles\";\nimport { getTags } from \"../../api/tag\";\nimport { mapState } from \"vuex\";\nexport default {\n  name: \"HomeIndex\",\n\n  watchQuery: [\"page\", \"tag\", \"tab\"],\n\n  async asyncData({ query, store }) {\n    let page = Number.parseInt(query.page) || 1;\n    let limit = 20;\n    const { tag } = query;\n    const tab = query.tab || \"global_feed\";\n    const loadArticles =\n      store.state.user && tab === \"your_feed\" ? getFeedArticles : getArticles;\n    const [articlesRes, tagRes] = await Promise.all([\n      loadArticles({\n        limit,\n        offset: (page - 1) * limit,\n        tag: query.tag,\n      }),\n      getTags(),\n    ]);\n\n    let { articles, articlesCount } = articlesRes.data;\n\n    let { tags } = tagRes.data;\n\n    articles.forEach((article) => (article.favoriteDisable = false));\n\n    //tags = tags.splice(0, 20); //数据处理\n\n    return {\n      articles,\n      articlesCount,\n      limit, //条数\n      page, //页数\n      tagResult: tags, //标签\n      tag,\n      tab: query.tab || \"global_feed\",\n    };\n  },\n\n  data() {\n    return {};\n  },\n\n  methods: {\n    async onFavorite(article) {\n      if (article.favorited) {\n        await delFavorite(article.slug);\n        article.favorited = false;\n        article.favoritesCount += -1;\n      } else {\n        await addFavorite(article.slug);\n        article.favorited = true;\n        article.favoritesCount += 1;\n      }\n      article.favoriteDisable = true;\n    },\n  },\n  mounted() {},\n  computed: {\n    totalPage() {\n      return Math.ceil(this.articlesCount / this.limit);\n    },\n    ...mapState([\"user\"]),\n  },\n};\n","import mod from \"-!../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js??ref--2-0!../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js??ref--2-0!../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=d554f9d0&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.9.6@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"d554f9d0\",\n  \"b67a9882\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAPA;AAQA;AAEA;AACA;AACA;AACA;AAFA;AAIA;AAEA;AACA;AACA;AACA;AAFA;AAIA;AAEA;AACA;AACA;AACA;AAFA;AAIA;AAEA;AACA;AACA;AACA;AAFA;AAIA;;;;;;;;;;;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;AClDA;AACA;AACA;AACA;AACA;AACA;AAFA;AAKA;;;;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAMA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAHA;AAQA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAEA;AACA;AAGA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAPA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAbA;AACA;AAaA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAJA;AA3DA;;ACnMA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}